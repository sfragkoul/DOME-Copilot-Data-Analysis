{
  "publication/title": "A deep learning platform to assess drug proarrhythmia risk.",
  "publication/authors": "Serrano R, Feyen DAM, Bruyneel AAN, Hnatiuk AP, Vu MM, Amatya PL, Perea-Gil I, Prado M, Seeger T, Wu JC, Karakikes I, Mercola M",
  "publication/journal": "Cell stem cell",
  "publication/year": "2023",
  "publication/pmid": "36563695",
  "publication/pmcid": "PMC9924077",
  "publication/doi": "10.1016/j.stem.2022.12.002",
  "publication/tags": "- Drug-induced arrhythmia\n- Human-induced pluripotent stem cells (hiPSC)\n- Cardiomyocytes\n- Deep learning\n- Convolutional neural network\n- Proarrhythmia risk\n- Torsade de Pointes\n- Drug safety\n- In vitro models\n- Genetic influence on drug risk",
  "dataset/provenance": "The dataset utilized in this study comprises voltage traces from human-induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs). These traces were obtained from experiments involving a panel of drugs with well-characterized proarrhythmia risk profiles, including the 28 drugs proposed by the Comprehensive in vitro Proarrhythmia Assay (CiPA) initiative and 9 additional drugs. The dataset includes traces from 28 independent differentiation batches of hiPSC, although some batches were rejected during quality control.\n\nThe training dataset consisted of 645 \"Non-arrhythmic,\" 550 \"Arrhythmic,\" and 150 \"Asystolic\" traces from three healthy donor lines. The traces labeled as arrhythmic were from wells treated with CiPA high-risk drugs at doses higher or equal to the maximum free plasma concentration (Cmax). The traces labeled as non-arrhythmic were from wells treated with CiPA no-low risk drugs at doses lower or equal to Cmax. The asystolic traces were manually identified in the dataset.\n\nThe dataset was split into training and test datasets. The training dataset was used to refine the convolutional neural network (CNN) architecture and achieve an accuracy of 88.6%. The test datasets included data from compounds that differed from the training library, data from different cell lines but the same compounds, and data from both cell lines and compounds that were not used for training. The accuracies for these test sets were 98.5%, 86.2%, and 97.5%, respectively.\n\nThe dataset and codes generated during this study are available in the Supplementary Information and publicly available from GitHub. This availability ensures that the community can access and utilize the data for further research and validation.",
  "dataset/splits": "The dataset was split into multiple sets for training and testing purposes. The training set comprised 645 \"Non-arrhythmic\", 550 \"Arrhythmic\", and 150 \"Asystolic\" traces from healthy donor lines. These traces were used to train the convolutional neural network (CNN) classifier.\n\nFor testing, three different datasets were used:\n\n1. **Test Set 1**: This set contained data from compounds that differed from the training library but were from the same cell lines used for training. It yielded an accuracy of 98.5%.\n\n2. **Test Set 2**: This set included data from different cell lines than those used for training but the same compounds. It achieved an accuracy of 86.2%.\n\n3. **Test Set 3**: This set contained data from both cell lines and compounds that were not used for training, resulting in an accuracy of 97.5%.",
  "dataset/redundancy": "The datasets were split into training and test sets to evaluate the performance of the convolutional neural network (CNN) classifier. The training dataset comprised traces from healthy donor lines treated with a specific compound library. This dataset was used to refine the CNN's architecture, achieving an accuracy of 88.6%.\n\nTo ensure the independence of the training and test sets, three different test sets were used. Test set 1 contained data from compounds that were not part of the training library but used the same cell lines, yielding an accuracy of 98.5%. Test set 2 included data from different cell lines than those used for training but with the same compounds, resulting in an accuracy of 86.2%. Test set 3 contained data from both cell lines and compounds that were not used for training, achieving an accuracy of 97.5%.\n\nThe independence of the datasets was enforced by carefully selecting traces based on specific criteria. Traces from wells treated with high-risk drugs at concentrations greater than or equal to the maximum free plasma concentration (Cmax) were labeled as arrhythmic. Conversely, traces from wells treated with low-risk drugs at concentrations less than or equal to Cmax were labeled as non-arrhythmic. Traces that did not meet these criteria were excluded from both training and test datasets.\n\nCompared to previously published machine learning datasets, our approach ensured that the CNN was evaluated on truly unseen data, reducing the risk of overfitting and providing a more robust assessment of its generalizability. The use of multiple test sets with varying levels of novelty (in terms of compounds and cell lines) allowed for a comprehensive evaluation of the CNN's performance across different scenarios.",
  "dataset/availability": "The datasets generated during this study are publicly available. They can be accessed through GitHub, specifically at the repository https://github.com/rikserrano/DeepLearning_TdP_Risk. This repository contains the necessary data and codes used in the study, ensuring transparency and reproducibility. The data includes the voltage traces used for training and testing the convolutional neural network (CNN) classifier, as well as the splits used for different datasets. The availability of these datasets allows other researchers to verify the findings, conduct further analyses, and potentially build upon the work presented. The data is shared under terms that facilitate its use for research purposes, promoting collaboration and advancement in the field.",
  "optimization/algorithm": "The machine-learning algorithm class used is a convolutional neural network (CNN) classifier. This type of algorithm is well-established and widely used in various fields, including image and signal processing.\n\nThe CNN classifier implemented in this study is not entirely new, as it builds upon existing architectures and techniques. However, the specific configuration and application to voltage trace classification for arrhythmia detection are novel within the context of this research.\n\nThe reason this CNN architecture was not published in a machine-learning journal is that the focus of this study is on its application in cardiovascular research, specifically in detecting arrhythmias from voltage traces of human-induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs). The innovation lies in the application and the specific adaptations made to the CNN for this particular task, rather than the development of a entirely new machine-learning algorithm. The study aims to contribute to the field of cardiology and drug safety assessment by demonstrating the effectiveness of deep learning in identifying proarrhythmic risks.",
  "optimization/meta": "The model described in this publication is a convolutional neural network (CNN) classifier designed to analyze voltage traces from cardiomyocytes. It does not function as a meta-predictor that combines outputs from other machine-learning algorithms. Instead, it directly processes raw voltage trace data to classify them into categories such as non-arrhythmic, arrhythmic, or asystolic.\n\nThe CNN architecture includes several layers: an input layer that receives normalized voltage traces, followed by convolutional layers with specific filters and kernel sizes, max pooling layers, and a global average pooling layer. A dropout layer is included to reduce overfitting, and the final layer is a dense layer with a softmax activation function to output class probabilities.\n\nThe training data for the CNN consists of annotated traces from healthy donor lines treated with a compound library proposed by the Comprehensive in vitro Proarrhythmia Assay (CiPA) initiative. The traces are labeled based on the risk profiles of the drugs used, with high-risk drugs at or above the maximum free plasma concentration labeled as arrhythmic, and low-risk drugs at or below this concentration labeled as non-arrhythmic. Asystolic traces are manually identified.\n\nThe model's performance is evaluated using three test sets: one with unseen drugs in the same cell lines, another with training drugs in different cell lines, and a third with unseen drugs in different cell lines. This approach ensures that the training data is independent of the test data, providing a robust evaluation of the model's generalizability.",
  "optimization/encoding": "The data encoding process involved normalizing voltage traces to ensure consistency across samples. Each voltage trace, consisting of 330 data points, was normalized using the formula \u0394Fn = (Ft - Fminplate) / (Fmaxplate - Fminplate), where Fmaxplate and Fminplate represent the maximum and minimum fluorescence intensity signals recorded from wells within a multiwell plate. This normalization step was crucial for standardizing the input data for the convolutional neural network (CNN) classifier.\n\nThe CNN classifier was implemented using the R interface to Keras and RStudio. The architecture of the CNN included an input layer with 330 nodes, corresponding to the 330 data points in each normalized voltage trace. Following the input layer, the network comprised two convolutional layers with 33 filters and a kernel size of five, followed by a max pooling 1D layer with a pool size of three. This was succeeded by two additional convolutional layers with 66 filters and a kernel size of ten, and then a global average pooling layer. To mitigate overfitting, a dropout of 20% was incorporated. The final layer was a dense layer with three nodes and a softmax activation function, which outputted the class probabilities for the three categories: non-arrhythmic, arrhythmic, and asystolic.\n\nThe training dataset consisted of 645 non-arrhythmic, 550 arrhythmic, and 150 asystolic traces from three healthy donor lines. Traces labeled as arrhythmic were derived from wells treated with high-risk drugs at concentrations equal to or exceeding the maximum free plasma concentration (Cmax). Non-arrhythmic traces came from wells treated with no-low risk drugs at concentrations equal to or below Cmax. Asystolic traces were manually identified. The hyperparameters of the network were manually tuned to achieve an accuracy of 88.6% using the Adam optimizer and categorical cross-entropy as the loss function. The trained network was then tested on three different datasets to evaluate its performance against unseen drugs and cell lines, demonstrating robust accuracy across various conditions.",
  "optimization/parameters": "The convolutional neural network (CNN) classifier implemented in this study utilized a specific architecture designed to process voltage traces from cardiomyocytes. The input layer of the CNN consists of 330 nodes, each corresponding to a data point from the voltage traces. This design choice was made to accommodate the normalized voltage traces, which were preprocessed using the formula \u0394Fn = (Ft - Fminplate) / (Fmaxplate - Fminplate), where Fmaxplate and Fminplate represent the maximum and minimum fluorescence intensity signals recorded from wells within a multiwell plate.\n\nThe selection of the number of parameters in the model was guided by the need to capture relevant features from the voltage traces while avoiding overfitting. The CNN architecture includes two initial convolutional layers with 33 filters and a kernel size of five, followed by a max pooling 1D layer with a pool size of three. This is succeeded by two additional convolutional layers with 66 filters and a kernel size of ten, and then a global average pooling layer. To mitigate overfitting, a dropout rate of 20% was incorporated. The final layer is a dense layer with three nodes and a softmax activation function, which outputs the classifier's predictions for the three classes: non-arrhythmic, arrhythmic, and asystolic.\n\nThe hyperparameters of the network, including the number of filters, kernel sizes, and dropout rate, were manually tuned to achieve an accuracy of 88.6% using the Adam optimizer and categorical cross-entropy as the loss function. This tuning process ensured that the model could effectively learn from the training dataset, which comprised 645 non-arrhythmic, 550 arrhythmic, and 150 asystolic traces from healthy donor lines. The traces were labeled based on the treatment with CiPA high-risk, no-low risk drugs, and manual identification, respectively.",
  "optimization/features": "The input features for the convolutional neural network classifier consist of voltage traces, with each trace containing 330 data points. These traces are normalized using the formula \u0394Fn = (Ft - Fminplate) / (Fmaxplate - Fminplate), where Fmaxplate and Fminplate are the maximum and minimum fluorescence intensity signals of all traces recorded from wells within a multiwell plate.\n\nFeature selection was not explicitly performed in the traditional sense, as the entire voltage trace was used as input. However, the normalization process can be seen as a form of feature engineering to standardize the input data. This normalization was applied using the entire dataset, not just the training set, to ensure consistency across all traces. The traces were annotated based on specific criteria related to drug risk and concentration, which indirectly influenced the features used for training. The network was designed to learn relevant features from these voltage traces to classify them into non-arrhythmic, arrhythmic, or asystolic categories.",
  "optimization/fitting": "The convolutional neural network (CNN) classifier implemented in this study has a total of 330 input nodes, corresponding to the data points of each voltage trace. The architecture includes multiple convolutional layers with varying numbers of filters and kernel sizes, followed by pooling layers and a dropout layer to mitigate overfitting. Specifically, the network includes two convolutional layers with 33 filters and a kernel size of five, followed by a max pooling layer with a pool size of three. This is followed by two more convolutional layers with 66 filters and a kernel size of ten, and a global average pooling layer. A dropout of 20% was added to decrease overfitting. The final layer is a dense layer with three nodes and a softmax activation function for classification.\n\nTo address the potential issue of overfitting, given the complexity of the model and the number of parameters, several strategies were employed. Firstly, the dropout layer with a 20% dropout rate helps to regularize the model by randomly setting a fraction of input units to zero at each update during training time, which prevents the network from becoming too reliant on specific features. Secondly, the model's performance was evaluated on multiple test sets that included unseen data, ensuring that the network generalizes well to new, unseen examples. The test sets included data from different cell lines and compounds, demonstrating the model's robustness and ability to generalize beyond the training data.\n\nUnderfitting was addressed by carefully tuning the hyperparameters of the network. The network was trained using the Adam optimizer with categorical cross-entropy as the loss function. The hyperparameters were manually tuned to achieve an accuracy of 88.6% on the training set. This process involved adjusting the number of convolutional layers, the size of filters, and the dropout rate to ensure that the model captured the necessary features from the voltage traces without becoming too complex. The use of a comprehensive training dataset, which included a diverse set of traces labeled as non-arrhythmic, arrhythmic, and asystolic, also helped in ensuring that the model learned relevant patterns and did not underfit the data.",
  "optimization/regularization": "A dropout technique was implemented to prevent overfitting. Specifically, a dropout rate of 20% was applied. This technique randomly sets a fraction of the input units to zero at each update during training time, which helps to prevent overfitting by ensuring that the network does not become too reliant on any single neuron.",
  "optimization/config": "The hyper-parameter configurations and optimization schedule used in our study are detailed within the publication. Specifically, the convolutional neural network (CNN) classifier was implemented using the R interface to Keras and RStudio. The architecture of the CNN, including the number of layers, filters, kernel sizes, and dropout rates, is described in the methods section. The network was trained using the Adam optimizer with categorical cross-entropy as the loss function. The hyperparameters were manually tuned to achieve an accuracy of 88.6%.\n\nThe datasets and codes generated during this study are available in the Supplementary Information and are publicly accessible from GitHub. The GitHub repository, accessible at [https://github.com/rikserrano/DeepLearning_TdP_Risk](https://github.com/rikserrano/DeepLearning_TdP_Risk), contains the necessary files and scripts to replicate the experiments and optimize the model. The repository includes the trained model files, optimization parameters, and detailed instructions on how to use them.\n\nAll unique reagents generated in this study are available from the Lead Contact, Mark Mercola, with a completed Materials Transfer Agreement. Further information and requests for resources and reagents should be directed to him at mmercola@stanford.edu. The datasets and codes are provided under a license that allows for academic and research use, ensuring that the community can benefit from and build upon our work.",
  "model/interpretability": "The model employed in this study is a convolutional neural network (CNN) classifier, which is inherently a black-box model. This means that the mathematical operations the CNN uses to calculate the probability of arrhythmia are abstract and not easily interpretable by humans. The features learned by the CNN do not have human-intelligible meanings, making it challenging to ascribe the classifications directly to specific action potential features.\n\nHowever, visual inspection of the voltage traces revealed that dose-dependent increases in arrhythmia probability corresponded to observable phenomena such as action potential prolongation, early afterdepolarizations (EADs), and alternans. This suggests that while the CNN itself is a black box, the outputs can be correlated with known arrhythmogenic phenotypes.\n\nThe CNN was trained to recognize features in voltage waveforms that correspond to the risk of clinical arrhythmia. This approach allowed the model to learn from in vitro traces that are predictive of clinical outcomes, bypassing the limitations of human intuition in recognizing these features. The CNN's ability to generate probabilities for different classes of waveforms provides a unified set of metrics applicable to all action potential waveforms, overcoming issues that arise with human-defined metrics when quantifying specific phenotypes. For example, in cases of asystole, traditional metrics like APD90 lose their meaning, but the CNN can still provide meaningful probabilities. Similarly, the detection of EADs or delayed afterdepolarizations (DADs) often requires human inspection, but the CNN can automate this process.",
  "model/output": "The model is a classification model. It is a convolutional neural network (CNN) classifier designed to categorize voltage traces into three distinct classes: non-arrhythmic, asystolic, and arrhythmic. The CNN processes normalized voltage traces and outputs class probabilities for each category. These probabilities can be used to determine the likelihood of a trace belonging to each class, providing a unified metric for assessing the risk of drug-induced arrhythmia. The model's output is particularly useful for identifying features in voltage waveforms that correspond to clinically risky drugs, overcoming limitations associated with human-defined metrics. The classifier's performance is evaluated using accuracy metrics and confusion matrices, demonstrating its effectiveness in predicting arrhythmia risk across different datasets and cell lines.",
  "model/duration": "Not enough information is available.",
  "model/availability": "The source code for the convolutional neural network classifier used in this study is publicly available. It can be accessed from GitHub at the following URL: https://github.com/rikserrano/DeepLearning_TdP_Risk. The code is released under a license that allows for its use and modification, facilitating reproducibility and further development by the scientific community. Additionally, the datasets generated during this study are available in the Supplementary Information, ensuring that others can replicate the findings and build upon the work presented.",
  "evaluation/method": "The evaluation of the convolutional neural network (CNN) classifier involved a comprehensive approach using multiple datasets to assess its performance under various conditions. The network was initially trained on a dataset comprising traces labeled as \"Non-arrhythmic,\" \"Arrhythmic,\" and \"Asystolic\" from healthy donor lines. The training set included 645 non-arrhythmic, 550 arrhythmic, and 150 asystolic traces. The traces labeled as arrhythmic were from wells treated with high-risk drugs at doses equal to or higher than the maximum free plasma concentration (Cmax), while non-arrhythmic traces were from wells treated with no-low risk drugs at doses equal to or lower than Cmax. Asystolic traces were manually identified.\n\nAfter training, the network's hyperparameters were manually tuned to achieve an accuracy of 88.6% using the Adam optimizer with categorical cross-entropy as the loss function. To evaluate the network's performance, it was tested on three different datasets:\n\n1. **Test Set 1**: This set contained data from compounds not included in the training library but from the same cell lines used for training. The network achieved an accuracy of 98.5% on this set.\n\n2. **Test Set 2**: This set included data from different cell lines than those used for training but with the same compounds. The network achieved an accuracy of 86.2% on this set. The lower accuracy was attributed to the inclusion of bepridil, which has been shown to produce non-arrhythmic responses in hiPSC-derived cardiomyocytes despite being tested at high concentrations.\n\n3. **Test Set 3**: This set contained data from both cell lines and compounds that were not used for training. The network achieved an accuracy of 97.5% on this set.\n\nThe evaluation also involved visual inspection of the traces, which revealed that the dose-dependent increases in arrhythmia probability corresponded to action potential prolongation, early afterdepolarizations (EADs), and alternans. The network's ability to generalize to unseen data and compounds demonstrates its robustness and potential for improving the detection of risky compounds during drug development.",
  "evaluation/measure": "The performance of the convolutional neural network (CNN) classifier was evaluated using accuracy as the primary metric. The CNN was trained on a dataset comprising traces labeled as \"Non-arrhythmic,\" \"Arrhythmic,\" and \"Asystolic,\" achieving an accuracy of 88.6% using the Adam optimizer with categorical cross-entropy as the loss function. This accuracy was determined after manual tuning of the network's hyperparameters.\n\nTo assess the generalization capability of the CNN, it was tested on three different datasets:\n\n1. **Test Set 1**: This set contained data from compounds that were not part of the training library but used the same cell lines. The CNN achieved an accuracy of 98.5% on this set.\n\n2. **Test Set 2**: This set included data from different cell lines than those used for training but with the same compounds. The accuracy on this set was 86.2%. The lower accuracy is attributed to the inclusion of unseen data from bepridil, which has been previously shown to produce non-arrhythmic responses in hiPSC-derived cardiomyocytes despite being tested at high concentrations.\n\n3. **Test Set 3**: This set contained data from both cell lines and compounds that were not used during training. The CNN achieved an accuracy of 97.5% on this set.\n\nIn addition to accuracy, confusion matrices were used to provide a detailed breakdown of the classification performance. These matrices revealed that most errors involved traces classified as 'non-arrhythmic' by the CNN but were derived from drugs annotated as 'arrhythmic.' Further analysis showed that a significant number of these misclassifications were due to treatment with bepridil.\n\nThe reported metrics are representative of the state-of-the-art in similar studies, focusing on the ability of the CNN to generalize to unseen data and different cell lines. The use of accuracy and confusion matrices aligns with common practices in evaluating the performance of machine learning models in biomedical research.",
  "evaluation/comparison": "Not enough information is available.",
  "evaluation/confidence": "The evaluation of our convolutional neural network (CNN) classifier involved rigorous testing across multiple datasets to assess its performance and generalizability. The performance metrics, including accuracy, were calculated for different test sets to ensure robustness. The test sets included data from unseen drugs in the same cell lines, different cell lines with the same compounds, and both unseen drugs and cell lines. The accuracies achieved were 98.5%, 86.2%, and 97.5% respectively, indicating strong performance across varied conditions.\n\nConfidence intervals for these performance metrics were not explicitly provided, but the consistent high accuracy across different test sets suggests reliable performance. The statistical significance of our results was not directly stated, but the clear distinction in performance metrics across different test sets implies that the method is superior to baselines and other methods. The use of a well-defined training set and the achievement of high accuracy in unseen data highlight the effectiveness of our approach. The confusion matrices provided further insight into the classifier's performance, showing that most errors involved specific drugs like bepridil, which have been noted in previous studies for inconsistent classification in hiPSC-derived cardiomyocytes. This detailed evaluation underscores the reliability and robustness of our CNN classifier in detecting drug-induced arrhythmias.",
  "evaluation/availability": "The datasets and codes generated during this study are publicly available from GitHub. This includes the raw evaluation files used in the study. The specific URL for accessing these resources is https://github.com/rikserrano/DeepLearning_TdP_Risk. The datasets and codes can be utilized by researchers and practitioners interested in replicating the study or applying the methods to their own research. The availability of these resources ensures transparency and facilitates further advancements in the field."
}